namespace = kor

kor.1 = { #Hangul event
  type = country_event
  
  title = kor.1.t
  desc = kor.1.d
  flavor = kor.1.f
  
  event_image = {
    video = "gfx/event_pictures/unspecific_ruler_speaking_to_people.bk2"
  }
  
  icon = "gfx/interface/icons/event_icons/event_portrait.dds"
  
  on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
  on_opened_soundeffect = "event:/SFX/Events/unspecific/leader_speaking_to_a_group_of_people"
  
  duration = 3
  
  trigger = {
    #Complete the issue of hanja journal entry
  }
  
  option = { #embrace hangul
    name = kor.1.a
    default_option = yes
    add_modifier = {
      name = modifier_kor_hangul
    }
    remove_modifier = modifier_kor_ill_fitting_writing_system
    if = { 
      limit = { is_subject_of = c:CHI }
      change_relations = {
        country = c:CHI
        value = -30
      }
    }
  }
  option = { #keep hanja
    name = kor.1.b
    add_modifier = {
      name = modifier_kor_kept_hanja
      is_decaying = yes
      months = 60
    }
    if = { 
      limit = { is_subject_of = c:CHI }
      change_relations = {
        country = c:CHI
        value = 30
      }
    }
  }
  option = { #use both
    name = kor.1.c
    remove_modifier = modifier_kor_ill_fitting_writing_system
    if = { 
      limit = { is_subject_of = c:CHI }
      change_relations = {
        country = c:CHI
        value = -5
      }
    }
  }

}

#kor.2 = { #gyeongbokgung event
#  type = country_event
#  placement = ROOT
#
#  title = kor.2.t
#  desc = kor.2.d
#  flavor = kor.2.f
#  
#  event_image = {
#    video = "gfx/event_pictures/asia_confucianism_shinto.bk2"
#  }
#
#  icon = "gfx/interface/icons/event_icons/event_portrait.dds"
#  
#  on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
#  on_opened_soundeffect = "event:/SFX/Events/unspecific/leader_speaking_to_a_group_of_people"
#  
#  duration = 3
#
#  trigger = {
#    year > 1845
#    exists = c:KOR
#    this = c:KOR
#    NOT = { has_global_variable = gyeongbokgung_restored }
#  }
#
#  immediate = {
#    set_global_variable = gyeongbokgung_restored
#  }
#
#  option = { #Restore the palace
#    name = kor.2.a
#    default_option = yes
#    add_modifier = {
#      name = modifier_kor_restoration_of_gyeongbokgung
#      months = 86
#    }
#  }
#  option = { #Don't restore the palace
#    name = kor.2.b
#    add_modifier = {
#      name = modifier_kor_delapidated_palace
#      months = 48
#    }
#  }

#}

kor.3 = { #China Appeased
  type = country_event
  
  title = kor.3.t
  desc = kor.3.d
  flavor = kor.3.f
  
	event_image = {
		video = "gfx/event_pictures/unspecific_military_parade.bk2"
	}

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/unspecific/military_parade"

	icon = "gfx/interface/icons/event_icons/event_chi.dds"
  
  duration = 3
  
  trigger = {
    #Complete sadae journal entry
  }

  immediate = {
    c:CHI = {
      save_scope_as = chi_scope
    }
  }
  
  option = { 
    name = kor.3.a
    default_option = yes
    custom_tooltip = kor_chi_alliance_tt
    set_variable = {
      name = kor_chi_alliance_available
    }
  }

}

kor.4 = { #China Angered
  type = country_event
  
  title = kor.4.t
  desc = kor.4.d
  flavor = kor.4.f
  
	event_image = {
		video = "gfx/event_pictures/asia_union_leader.bk2"
	}

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/asia/union_leader"

	icon = "gfx/interface/icons/event_icons/event_portrait.dds"
  
  duration = 3
  
  trigger = {
    #Fail sadae journal entry
  }

  immediate = {
    c:KOR= {
      save_scope_as = kor_scope
    }
  }
  
  option = { #subjugate korea
    name = kor.4.a
    default_option = yes
    ai_chance = { base = 1 }

    if = {
      limit = {
        is_country_type = recognized
      }
      create_diplomatic_play = {
        name = korean_subjugation
      
        target_country = c:KOR
        
        type = dp_make_puppet
  
        add_war_goal = {
          holder = c:KOR
          type = independence
          target_state = s:STATE_BEIJING.region_state:CHI
        }
  
      }
    }
    else = {
      create_diplomatic_play = {
        name = korean_subjugation
      
        target_country = c:KOR
        
        type = dp_make_vassal
  
        add_war_goal = {
          holder = c:KOR
          type = independence
          target_state = s:STATE_BEIJING.region_state:CHI
        }
  
      }
    }

    
  }
  option = { #let korea go
    name = kor.4.b

    ai_chance = { base = 0 }
    
    add_modifier = {
			name = china_let_korea_go
			months = short_modifier_time
		}
  }

}

kor.5 = {
  type = country_event

  title = kor.5.t
  desc = kor.5.d
  flavor = kor.5.f
  
  event_image = {
    video = "gfx/event_pictures/unspecific_ruler_speaking_to_people.bk2"
  }

  on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
  on_opened_soundeffect = "event:/SFX/Events/asia/union_leader"

  icon = "gfx/interface/icons/event_icons/event_chi.dds"

  duration = 1
  immediate = {
    if = {
      limit = { active_law:lawgroup_governance_principles.type != scope:china_governance_principles }
      set_variable = kor_chi_gov_principle_broken
    }
    if = {
      limit = { active_law:lawgroup_distribution_of_power.type != scope:china_distribution_of_power }
      set_variable = kor_chi_distr_of_power_broken
    }
    if = {
      limit = { active_law:lawgroup_land_reform.type != scope:china_land_reform }
      set_variable = kor_chi_land_reform_broken
    }
    if = {
      limit = { active_law:lawgroup_church_and_state.type != scope:china_church_and_state }
      set_variable = kor_chi_church_and_state_broken
    }
  }
  option = {
    name = kor.5.a
    default_option = yes
    add_journal_entry = { type = je_sojunghwa }
  }
}

kor.6 = { #Successor to the mandate of heaven
  type = country_event
  placement = root

  title = kor.6.t
  desc = kor.6.d
  flavor = kor.6.f
  
  event_image = {
    video = "gfx/event_pictures/asia_confucianism_shinto.bk2"
  }

  on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
  on_opened_soundeffect = "event:/SFX/Events/asia/confucianism_shinto"

  icon = "gfx/interface/icons/event_icons/waving_flag.dds"

  duration = 12
  trigger = {
    exists = c:KOR
    this = c:KOR
    has_global_variable = china_shatters
    has_technology_researched = pan-nationalism
    NOT = { has_variable = korean_mandate_event }
  }

  immediate = {
    set_variable = korean_mandate_event
  }
  option ={ #take the mandate of heaven
    name = kor.6.a 
    ai_chance = { base = 0 }
    add_primary_culture = cu:han
    custom_tooltip = {
      text = claim_china_tt
      every_state_region = {
        limit = {
          OR = {
            is_homeland = cu:han
            is_homeland = cu:manchu
          }
        }
        add_claim = c:KOR
      }
      every_country = {
        limit = { 
          country_has_primary_culture = cu:han
        }
        change_relations = {
          country = c:KOR
          value = -80
        }
      }
    }
  }
  option = { #ignore the mandate of heaven
    name = kor.6.b
    ai_chance = { base = 1 }
    every_country = {
      limit = { 
        country_has_primary_culture = cu:han
      }
      change_relations = {
        country = c:KOR
        value = 20
      }
    }
  }
}

kor.7 = {
  type = country_event
  placement = root
  hidden = yes
  trigger = {
    root = c:CHI
    was_formed_from = KOR
    NOT = { has_variable = korean_culture }
  }
  immediate = {
    add_primary_culture = cu:korean
    remove_primary_culture = cu:manchu
    set_variable = korean_culture
  }
}

kor.8 = {
  type = country_event
  placement = root

  title = kor.8.t
  desc = kor.8.d
  flavor = kor.8.f
  
  event_image = {
    video = "gfx/event_pictures/asia_confucianism_shinto.bk2"
  }

  on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
  on_opened_soundeffect = "event:/SFX/Events/asia/confucianism_shinto"

  icon = "gfx/interface/icons/event_icons/waving_flag.dds"

  duration = 1

  option = {
    name = kor.8.a
    default_option = yes
    add_journal_entry = { type = je_gwangmu_nationalism }
    add_journal_entry = { type = je_gwangmu_army }
    add_journal_entry = { type = je_gwangmu_navy }
    add_journal_entry = { type = je_gwangmu_taxes }
    add_journal_entry = { type = je_gwangmu_democracy }
    add_journal_entry = { type = je_gwangmu_main }
  }
}

##
## TODO: GWANGMU EVENTS
## Random Events triggered on monthly pulse through je_gwangmu_main
## - AI CHANCE NOT DONE

kor.9 = { #gwangmu nationalism
  type = country_event
  placement = root

  title = kor.9.t
  desc = kor.9.d
  flavor = kor.9.f
  
  event_image = {
    video = "gfx/event_pictures/asia_confucianism_shinto.bk2"
  }

  on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
  on_opened_soundeffect = "event:/SFX/Events/asia/confucianism_shinto"

  icon = "gfx/interface/icons/event_icons/waving_flag.dds"

  immediate = {
    random_country = {
      limit = { 
        country_rank = rank_value:great_power 
        relations:root >= relations_threshold:neutral
      }
      save_scope_as = nationalism_country_1
    }
    random_country = {
      limit = { 
        country_rank = rank_value:great_power 
        relations:root >= relations_threshold:neutral
        this != scope:nationalism_country_1
      }
      save_scope_as = nationalism_country_2
    }
  }

  duration = 3
  #TODO
  #A: (jpn has meiji) korea gets independent, free trade, add jpn influence JE, add variable ganghwa island treaty
  option = {
    name = kor.9.a
    highlighted_option = yes
    trigger = { 
      exists = { c:JAP } 
      c:JAP = { has_variable = meiji_reforms_complete_var } 
    }
    make_independent = yes
    if = {
      limit = { NOT = { has_law = law_type:law_free_trade } }
      activate_law = law_type:law_free_trade
    }
    if = {
      limit = { NOT = { has_journal_entry = je_jpn_influence_kor } }
      add_journal_entry = { type = je_jpn_influence_kor }
    }
    hidden_effect = { 
      set_variable = { name = ganghwa_island_treaty } 
      change_variable = { 
        name = japanese_influence 
        add = 1
      }
    }
  }
  #B: sovereignty mission to great power i, GPi gets event with option start diplo play free subject
  option = {
    name = kor.9.b
    add_treasury = -165000
    scope:nationalism_country_1 = {
      trigger_event = {
        id = kor.14
        days = 14
      }
    }
  }
  #C: sovereignty mission to great power ii, GPii gets event with option start diplo play free subject
  option = {
    name = kor.9.b
    add_treasury = -165000
    scope:nationalism_country_2 = {
      trigger_event = {
        id = kor.14
        days = 14
      }
    }
  }
}

kor.10 = { #gwangmu army
  type = country_event
  placement = root

  title = kor.10.t
  desc = kor.10.d
  flavor = kor.10.f
  
  event_image = {
    video = "gfx/event_pictures/asia_confucianism_shinto.bk2"
  }

  on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
  on_opened_soundeffect = "event:/SFX/Events/asia/confucianism_shinto"

  icon = "gfx/interface/icons/event_icons/event_military.dds"

  immediate = {
    random_country = {
      limit = { 
        country_rank = rank_value:great_power 
        relations:root >= relations_threshold:neutral
      }
      save_scope_as = army_country_1
    }
    random_country = {
      limit = { 
        country_rank = rank_value:great_power 
        relations:root >= relations_threshold:neutral
        this != scope:nationalism_country_1
      }
      save_scope_as = army_country_2
    }
  }

  duration = 3
  #TODO
  #A: (jpn has meiji) research next possible mil tech, enact professional army, add jpn influence JE, add variable 'jpnese in army'
  option = {
    name = kor.10.a
    highlighted_option = yes
    trigger = { 
      exists = { c:JAP } 
      c:JAP = { has_variable = meiji_reforms_complete_var } 
    }

    if = {
      limit = { NOT = { has_journal_entry = je_jpn_influence_kor } }
      add_journal_entry = { type = je_jpn_influence_kor }
    }

    add_technology_researched = general_staff

    if = {
      limit = { has_law = law_type:law_peasant_levies }
      activate_law = law_type:law_professional_army
    }

    hidden_effect = {

      add_technology_researched = army_reserves
      add_technology_researched = line_infantry
      add_technology_researched = mandatory_service
      add_technology_researched = military_drill
      add_technology_researched = standing_army 
      
      set_variable = { name = jpn_in_army } 
      change_variable = { 
        name = japanese_influence 
        add = 1
      }
    }
  }
  #B: army advisors from great power i, improve relations, tech progress on next important mil tech
  option = {
    name = kor.10.b
    change_relations = {
      country = scope:army_country_1
      value = 20
    }
    add_treasury = -150000
    scope:army_country_1 = { add_treasury = 150000 }
    add_technology_progress = { 
      progress = 5000
      technology = general_staff
    }
    hidden_effect = {
      add_technology_researched = army_reserves
      add_technology_researched = line_infantry
      add_technology_researched = mandatory_service
      add_technology_researched = military_drill
      add_technology_researched = standing_army 
    }
  }
  #C: army advisors from great power ii, improve relations, enact professional army
  option = {
    name = kor.10.b
    change_relations = {
      country = scope:army_country_2
      value = 20
    }
    add_treasury = -150000
    scope:army_country_1 = { add_treasury = 150000 }
    if = { 
      limit = { has_law = law_type:law_peasant_levies } 
      activate_law = law_type:professional_army 
    }
  }
}

kor.11 = { #gwangmu navy, establishment of naval academy
  type = country_event
  placement = root

  title = kor.11.t
  desc = kor.11.d
  flavor = kor.11.f
  
  event_image = {
    video = "gfx/event_pictures/asia_confucianism_shinto.bk2"
  }

  on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
  on_opened_soundeffect = "event:/SFX/Events/asia/confucianism_shinto"

  icon = "gfx/interface/icons/event_icons/event_military.dds"

  immediate = {
    random_country = {
      limit = { 
        country_rank = rank_value:great_power 
        relations:root >= relations_threshold:neutral
      }
      save_scope_as = navy_country_1
    }
    random_country = {
      limit = { 
        country_rank = rank_value:great_power 
        relations:root >= relations_threshold:neutral
        this != scope:nationalism_country_1
      }
      save_scope_as = navy_country_2
    }
    random_country = {
      limit = { 
        country_rank = rank_value:great_power 
        relations:root >= relations_threshold:neutral
        this != scope:nationalism_country_1
        this != scope:nationalism_country_2
      }
      save_scope_as = navy_country_3
    }
  }

  duration = 3
  #TODO
  #A: purchase ships from great power i, improve relations, lose money, GPi gains money, build lvl 5 naval base in STATE_BUSAN
  option = {
    name = kor.11.a
    change_relations = {
      country = scope:navy_country_1
      value = 20
    }
    add_treasury = -2000000
    scope:navy_country_1 = { add_treasury = 2000000 }
    create_building = {
      building = building_naval_base
      reserves = 0.5
      level = 5
    }
  }
  #B: acquire tech from great power ii, improve relations, research next important naval tech
  option = {
    name = kor.11.b
    change_relations = {
      country = scope:navy_country_2
      value = 20
    }
    add_treasury = -1200000
    scope:navy_country_2 = { add_treasury = 1200000 }
    add_technology_researched = screw_frigate
    hidden_effect = {
      add_technology_researched = paddle_steamer
      add_technology_researched = admiralty
      add_technology_researched = navigation
    }
  }
  option = {
    name = kor.11.c
    change_relations = {
      country = scope:navy_country_3
      value = 20
    }
    add_treasury = -1200000
    scope:navy_country_3 = { add_treasury = 1200000 }
    add_technology_researched = power_of_the_purse
    hidden_effect = {
      add_technology_researched = admiralty
      add_technology_researched = navigation
    }
  }
}

#kor.12 = { #gwangmu taxes
  #TODO
  #A: (jpn has meiji) enact per capita tax, add jpn influence JE, add variable 'using jpnese currency'
  #B: (has debt)(jpn has meiji) remove all debt, enact per capita tax, add jpn influence JE, add variable 'using jpnese currency'
  #C: (autocracy) enact per capita tax, landowners malus approval, landowners add radicals
#}

#kor.13 = { #gwangmu democracy
  #TODO
  #A: (jpn has meiji) set leader ig to industrialist, enact oligarchy, add variable 'jpnese in govt'
  #B: copy great power i (random democratic GP), landowner leader becomes republican
  #C: (has autocracy, monarchy)copy great power ii (random democratic GP), enact wealth voting
#}

kor.100 = { #DEBUG EVENT
  type = country_event
  placement = root

  title = kor.100.t
  desc = kor.100.d
  flavor = kor.100.f
  
  event_image = {
    video = "gfx/event_pictures/asia_confucianism_shinto.bk2"
  }

  on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
  on_opened_soundeffect = "event:/SFX/Events/asia/confucianism_shinto"

  icon = "gfx/interface/icons/event_icons/waving_flag.dds"

  duration = 12
  option = {
    name = kor.100.a
    default_option = yes
  }
}
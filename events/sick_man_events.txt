namespace = sick_man

# start event
sick_man.1 = {
	type = country_event
	placement = root
	title = sick_man.1.t
	desc = sick_man.1.d
	flavor = sick_man.1.f

	duration = 3

	event_image = {
		video = "gfx/event_pictures/unspecific_factory_closed.bk2"
	}

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/unspecific/factory_closed"

	icon = "gfx/interface/icons/event_icons/event_skull.dds"

	trigger = {
	}

	immediate = {
		set_variable = {
			name = sick_man_var
			value = 0
		}
		set_variable = {
			name = sick_man_separatist_var
			value = 0
		}
		add_journal_entry = {
			type = je_sick_man_main
		}
		s:STATE_ALBANIA = {
			random_scope_state = {
				limit = {
					owner = {
						c:TUR = THIS
					}
				}
				save_scope_as = albania_state
			}
		}
		s:STATE_BOSNIA = {
			random_scope_state = {
				limit = {
					owner = {
						c:TUR = THIS
					}
				}
				save_scope_as = bosnia_state
			}
		}
		s:STATE_THESSALIA = {
			random_scope_state = {
				limit = {
					owner = {
						c:TUR = THIS
					}
				}
				save_scope_as = greek_state
			}
		}
		s:STATE_BULGARIA = {
			random_scope_state = {
				limit = {
					owner = {
						c:TUR = THIS
					}
				}
				save_scope_as = bulgar_state
			}
		}
		s:STATE_NORTHERN_THRACE = {
			random_scope_state = {
				limit = {
					owner = {
						c:TUR = THIS
					}
				}
				save_scope_as = bulgar_state2
			}
		}
		s:STATE_MACEDONIA = {
			random_scope_state = {
				limit = {
					owner = {
						c:TUR = THIS
					}
				}
				save_scope_as = macedonia_state
			}
		}
		s:STATE_SKOPIA = {
			random_scope_state = {
				limit = {
					owner = {
						c:TUR = THIS
					}
				}
				save_scope_as = macedonia_state2
			}
		}
		s:STATE_SOUTHERN_SERBIA = {
			random_scope_state = {
				limit = {
					owner = {
						c:TUR = THIS
					}
				}
				save_scope_as = serbia_state
			}
		}
	}

	option = {
		name = sick_man.1.a
		add_journal_entry = {
			type = je_sick_man_syria
		}
		add_journal_entry = {
			type = je_sick_man_economy
		}
		add_journal_entry = {
			type = je_sick_man_education
		}
		add_journal_entry = {
			type = je_sick_man_separatism
		}
		add_journal_entry = {
			type = je_sick_man_army
		}
		add_journal_entry = {
			type = je_sick_man_bureaucracy
		}
		add_journal_entry = {
			type = je_sick_man_kurdistan
		}
		show_as_tooltip = {
			add_modifier = {
				name = sick_man_of_europe
				months = -1
			}		
			add_modifier = {
				name = outmoded_bureaucracy
				months = -1
			}
			add_modifier = {
				name = cizye_tax
				months = -1
			}			
		}
		hidden_effect = {
			scope:albania_state = {
				add_radicals = {
					value = very_large_radicals
					culture = cu:albanian
				}
			}
			scope:bosnia_state = {
				add_radicals = {
					value = very_large_radicals
				}
			}
			scope:serbia_state = {
				add_radicals = {
					value = very_large_radicals
					religion = rel:orthodox
				}
			}
			scope:greek_state = {
				add_radicals = {
					value = very_large_radicals
					religion = rel:orthodox
				}
			}
			scope:macedonia_state = {
				add_radicals = {
					value = very_large_radicals
					religion = rel:orthodox
				}
			}
			scope:macedonia_state2 = {
				add_radicals = {
					value = very_large_radicals
					religion = rel:orthodox
				}
			}
			scope:bulgar_state = {
				add_radicals = {
					value = very_large_radicals
					religion = rel:orthodox
				}
			}
			scope:bulgar_state2 = {
				add_radicals = {
					value = very_large_radicals
					religion = rel:orthodox
				}
			}
		}
	}
}

# Success event
sick_man.2 = {
	type = country_event
	placement = root
	title = sick_man.2.t
	desc = sick_man.2.desc
	flavor = sick_man.2.f

	icon = "gfx/interface/icons/event_icons/event_scales.dds"

	duration = 3

	event_image = {
		video = "gfx/event_pictures/europenorthamerica_london_center.bk2"
	}

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/europenorthamerica/london_center"

	trigger = {
	}

	immediate = {
		set_variable = sick_man_complete
		remove_modifier = outmoded_bureaucracy
		remove_modifier = cizye_tax
	}

	option = {
		name = sick_man.2.a
		default_option = yes
		trigger = {
			has_variable = completed_sick_man_army_je
		}
		add_modifier = {
			name = ottoman_army_reform
			months = normal_modifier_time
		}
	}
	option = {
		name = sick_man.2.c
		trigger = {
			has_variable = completed_sick_man_economy_je
		}
		add_modifier = {
			name = ottoman_urbanization
			months = normal_modifier_time
		}
	}
	option = {
		name = sick_man.2.d
		trigger = {
			has_variable = completed_sick_man_education_je
		}
		add_modifier = {
			name = ottoman_education
			months = normal_modifier_time
		}
	}
	option = {
		name = sick_man.2.e
		trigger = {
			has_variable = completed_sick_man_bureaucracy_je
		}
		add_modifier = {
			name = ottoman_bureaucracy
			months = normal_modifier_time
		}
	}
}

# Fail event
sick_man.3 = {
	type = country_event
	placement = root
	title = sick_man.3.t
	desc = sick_man.3.d
	flavor = sick_man.3.f
	icon = "gfx/interface/icons/event_icons/event_skull.dds"

	duration = 3

	event_image = {
		video = "gfx/event_pictures/unspecific_factory_closed.bk2"
	}

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/unspecific/factory_closed"

	trigger = {
	}

	immediate = {
		set_variable = sick_man_complete
		remove_modifier = outmoded_bureaucracy
		remove_modifier = cizye_tax
		ruler = {
			save_scope_as = ottoman_sultan
		}
		if = {
			limit = {
				OR = {
					has_law = law_type:law_racial_segregation
					has_law = law_type:law_multicultural
				}
			}
			activate_law = law_type:law_national_supremacy
		}
		if = {
			limit = {
				OR = {
					has_law = law_type:law_right_of_assembly
					has_law = law_type:law_protected_speech
				}
			}
			activate_law = law_type:law_censorship
		}
		if = {
			limit = {
				OR = {
					has_law = law_type:law_women_own_property
					has_law = law_type:law_women_in_the_workplace
					has_law = law_type:law_womens_suffrage
				}
			}
			activate_law = law_type:law_no_womens_rights
		}
		if = {
			limit = {
				OR = {
					has_law = law_type:law_total_separation
					has_law = law_type:law_freedom_of_conscience
					has_law = law_type:law_denominational_exclusion
				}
			}
			activate_law = law_type:law_state_religion
		}
		if = {
			limit = {
				OR = {
					has_law = law_type:law_landed_voting
					has_law = law_type:law_census_voting
					has_law = law_type:law_wealth_voting
					has_law = law_type:law_universal_suffrage
				}
			}
			activate_law = law_type:law_autocracy
		}
		#if = { #Debating this one, might be a touch ahistorical as reforms continued under Abdulhamid II but were refocused on the military
		#	limit = {
		#		OR = {
		#			has_law = law_type:law_interventionism
		#			has_law = law_type:law_agrarianism
		#			has_law = law_type:law_laissez_faire
		#			has_law = law_type:law_command_economy
		#		}
		#	}
		#	activate_law = law_type:law_traditionalism
		#}		
	}

	option = {
		name = sick_man.3.a
		if = {
			limit = {
				any_subject_or_below = {
					NOT = {
						is_country_type = unrecognized
					}
				}
			}
			every_subject_or_below = {
				limit = {
					OR = {
						NOT = {
							is_country_type = unrecognized
						}
						is_subject_type = subject_type_protectorate
						is_subject_type = subject_type_dominion
						is_subject_type = subject_type_puppet
					}
				}
				make_independent = yes
			}
		}
		set_country_type = unrecognized
		ruler = {
			kill_character = yes
		}
	}
}
